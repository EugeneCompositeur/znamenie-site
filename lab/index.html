<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Храм Знамения Пресвятой Богородицы в Париже</title>
  <meta name="description" content="Официальный сайт Храма Знамения Пресвятой Богородицы в Париже. Православное расписание богослужений, адрес, контакты." />
  <link rel="icon" href="assets/icon2.gif" type="image/gif" />
  <link href="https://fonts.googleapis.com/css2?family=Forum&family=Open+Sans&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bogoroditsa-blue: #1939A5;
      --bogoroditsa-blue-dark: #142779;
      --schedule-panel-padding: 1.1em 2.1em;
      --schedule-panel-padding-mobile: 0.7em 0.5em;
      --transition: 0.28s cubic-bezier(.57,.11,.59,.89);
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: #f3eee3;
      font-family: 'Open Sans', Arial, sans-serif;
      color: #232323;
      min-height: 100vh;
      width: 100vw;
      overflow-x: hidden;
    }
    body {
      min-height: 100vh;
    }
    .lang-switch {
      position: absolute;
      top: 1em;
      right: 1em;
      z-index: 120;
      display: flex;
      gap: 1.1em;
      font-size: 1.12em;
      font-family: 'Open Sans', sans-serif;
      letter-spacing: 0.07em;
    }
    .lang-switch span {
      cursor: pointer;
      color: #7a7a7a;
      font-weight: 700;
      transition: color 0.22s;
      user-select: none;
      padding: 0 0.1em;
    }
    .lang-switch span.active {
      color: var(--bogoroditsa-blue);
    }
    .lang-switch span:hover {
      color: var(--bogoroditsa-blue-dark);
    }
    .header {
      text-align: center;
      margin-top: 2.4em;
      margin-bottom: 1.2em;
      position: relative;
    }
    .header-inner {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.3em;
    }
    .header-logo {
      width: 104px;
      height: auto;
      margin-bottom: 0.3em;
      margin-top: 0.3em;
      filter: drop-shadow(0 2px 24px #1939a512);
    }
    .header-names {
      display: flex;
      flex-direction: row;
      gap: 2em;
      justify-content: center;
      align-items: flex-start;
      width: 100%;
    }
    .header-title {
      font-family: 'Forum', serif;
      color: var(--bogoroditsa-blue);
      font-weight: 400;
      font-size: 2.7em;
      line-height: 1.05;
      margin: 0;
      letter-spacing: 0.01em;
      white-space: pre-line;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
    }
    .header-title.right {
      align-items: flex-start;
    }
    .subheading {
      font-size: 1.03em;
      margin-top: 0.5em;
      margin-bottom: 1.6em;
      font-family: 'Forum', serif;
      color: #757575;
      letter-spacing: 0.01em;
      max-width: 650px;
      margin-left: auto;
      margin-right: auto;
    }
    /* Расписание */
    #schedulePanel {
      background: var(--bogoroditsa-blue);
      color: #fff;
      width: 100vw;
      margin-left: -8px;
      margin-right: -8px;
      margin-bottom: 0.5em;
      padding: var(--schedule-panel-padding);
      box-sizing: border-box;
      border: none;
      box-shadow: 0 4px 32px #1939a525;
      transition: padding var(--transition), min-height var(--transition), box-shadow var(--transition);
      position: relative;
      z-index: 10;
      cursor: pointer;
      min-height: 72px;
      overflow: visible;
      border-radius: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start;
    }
    #schedulePanel.expanded {
      background: var(--bogoroditsa-blue);
      box-shadow: 0 16px 70px #1939a550;
      z-index: 100;
      opacity: 0.96;
      padding-bottom: 3.1em;
      min-height: 360px;
    }
    #mainSchedule, #hiddenSchedule {
      margin: 0;
      padding: 0;
      list-style: none;
      width: 100%;
      max-width: 1300px;
      display: flex;
      flex-direction: column;
      gap: 0.14em;
    }
    #mainSchedule li, #hiddenSchedule li {
      font-size: 1.14em;
      line-height: 1.28;
      margin-bottom: 0.22em;
      color: #fff;
      font-weight: 400;
      letter-spacing: 0.01em;
      text-align: left;
      text-shadow: 0 2px 10px #0001;
      padding-left: 1.1em;
      transition: opacity 0.22s;
    }
    #mainSchedule li strong, #hiddenSchedule li strong {
      font-size: 1.01em;
      font-weight: 700;
      color: #fff;
    }
    /* стрелка вниз */
    .panel-arrow {
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0.6em 0 0 0;
      pointer-events: none;
      transition: opacity .22s;
    }
    .panel-arrow svg {
      width: 28px;
      height: 28px;
      fill: #fff;
      opacity: 0.78;
      transition: transform .3s;
    }
    #schedulePanel.expanded .panel-arrow svg {
      transform: rotate(180deg) scale(1.07);
    }
    #hiddenSchedule {
      display: none;
      padding-top: 0.5em;
      width: 100%;
      opacity: 0.98;
    }
    #schedulePanel.expanded #hiddenSchedule {
      display: block;
      animation: fadeIn .28s;
    }
    /* Подложка под расписанием для эффекта перекрытия */
    #schedulePanel.expanded ~ .blocks-row {
      pointer-events: none;
      filter: blur(2.2px) brightness(.97);
      opacity: 0.55;
      transform: scale(.99);
      transition: all .18s;
    }
    .blocks-row {
      display: flex;
      flex-wrap: wrap;
      gap: 2em;
      justify-content: center;
      margin-top: 3.3em;
      margin-bottom: 3em;
      z-index: 1;
      transition: filter .18s, opacity .18s, transform .18s;
    }
    .card-block {
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 4px 28px #1939a51a;
      width: 255px;
      min-height: 190px;
      cursor: pointer;
      transition: transform 0.23s, box-shadow 0.2s;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .card-block:hover {
      transform: scale(1.035);
      box-shadow: 0 12px 48px #1939a53a;
    }
    .card-block img {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-top-left-radius: 18px;
      border-top-right-radius: 18px;
    }
    .card-title {
      font-family: 'Forum', serif;
      font-size: 1.19em;
      color: var(--bogoroditsa-blue);
      margin: 1em 0 0.6em 0;
      font-weight: 700;
    }
    .card-desc {
      font-size: 1em;
      color: #474747;
      margin-bottom: 1em;
      padding: 0 1em;
    }
    .footer {
      margin: 2em auto 1.5em auto;
      font-size: 1em;
      color: #555;
      text-align: center;
    }
    .footer a { color: var(--bogoroditsa-blue); text-decoration: underline; }
    @media (max-width: 1050px) {
      .blocks-row { gap: 1.2em; }
      #mainSchedule li, #hiddenSchedule li { font-size: 1.06em; }
    }
    @media (max-width: 820px) {
      .header-names { flex-direction: column; gap: 0; }
      .header-title { font-size: 2.15em; }
      .header { margin-top: 2em; }
    }
    @media (max-width: 600px) {
      .lang-switch {
        position: fixed;
        top: 7px; right: 11px;
        background: #f3eee3cc;
        border-radius: 7px;
        padding: 0.07em 0.45em;
        z-index: 200;
        font-size: 1.02em;
      }
      .header {
        margin-top: 2.7em;
      }
      .header-title { font-size: 1.18em; }
      .header-logo { width: 74px; }
      .subheading { font-size: 0.92em; }
      #schedulePanel, #schedulePanel.expanded {
        padding: var(--schedule-panel-padding-mobile);
        font-size: 0.97em;
        min-height: 49px;
      }
      #mainSchedule li, #hiddenSchedule li {
        font-size: 0.93em;
        padding-left: 0.7em;
      }
      .blocks-row {
        margin-top: 2em;
        gap: 0.7em;
      }
      .card-block {
        width: 97vw;
        min-height: 105px;
        border-radius: 10px;
      }
      .footer { font-size: 0.91em; }
    }
    @keyframes fadeIn { from {opacity:0} to {opacity:1} }
  </style>
</head>
<body>
  <div class="lang-switch" role="group" aria-label="Переключение языков">
    <span class="active" data-lang="ru">RU</span>
    <span data-lang="fr">FR</span>
    <span data-lang="by">BY</span>
    <span data-lang="ua">UA</span>
  </div>
  <div class="header">
    <div class="header-inner">
      <div class="header-names">
        <div class="header-title" id="logo-left">
          <span>Храм</span>
          <span>Знамения</span>
        </div>
        <img src="assets/icon2.gif" class="header-logo" alt="Икона Богородицы" />
        <div class="header-title right" id="logo-right">
          <span>Пресвятой</span>
          <span>Богородицы</span>
        </div>
      </div>
      <div class="subheading" id="subheading">
        Викариат имени Святых Марии Парижской и Алексия Южинского — Вселенский Патриархат
      </div>
    </div>
  </div>

  <div id="schedulePanel">
    <ul id="mainSchedule"></ul>
    <div class="panel-arrow"><svg viewBox="0 0 24 24"><path d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"/></svg></div>
    <ul id="hiddenSchedule"></ul>
  </div>

  <div class="blocks-row" id="main-blocks">
    <div class="card-block" data-block="history">
      <img src="assets/church_outside.jpg" alt="Вид храма" />
      <div class="card-title">История прихода</div>
      <div class="card-desc">Как всё начиналось. Кратко о главном.</div>
    </div>
    <div class="card-block" data-block="icon">
      <img src="assets/icon_inside.jpg" alt="Икона Знамения" />
      <div class="card-title">Икона Знамения</div>
      <div class="card-desc">Главная святыня храма — история и чудеса.</div>
    </div>
    <div class="card-block" data-block="schedule">
      <img src="assets/service.jpg" alt="Богослужение" />
      <div class="card-title">Богослужения</div>
      <div class="card-desc">Как устроено расписание, ответы на вопросы.</div>
    </div>
    <div class="card-block" data-block="community">
      <img src="assets/movement_blanc.jpg" alt="Община" />
      <div class="card-title">Белое движение</div>
      <div class="card-desc">О нашей общине, жизни вне богослужений.</div>
    </div>
  </div>

  <div class="footer" id="footer">
    87, boulevard Exelmans, Paris 75016<br />
    Метро: Exelmans (ligne 9)<br />
    ✉️ <a id="email" href="mailto:ndsigne@gmail.com">ndsigne@gmail.com</a>
  </div>

  <script>
    // Тексты расписания для всех языков — как раньше!
    const translations = {
      ru: {
        logoLeft: ["Храм", "Знамения"],
        logoRight: ["Пресвятой", "Богородицы"],
        subheading: "Викариат имени Святых Марии Парижской и Алексия Южинского — Вселенский Патриархат",
        mainSchedule: [
          "<strong>16 суббота, 18:00</strong> – Всенощная (Неделя 10-я по Пятидесятнице) Глас 1-й",
          "<strong>17 воскресенье, 10:30</strong> – Литургия (Свв. семи отроков, иже во Ефесе)"
        ],
        fullSchedule: [
          "<strong>16 суббота, 18:00</strong> – Всенощная (Неделя 10-я по Пятидесятнице) Глас 1-й",
          "<strong>17 воскресенье, 10:30</strong> – Литургия (Свв. семи отроков, иже во Ефесе)",
          "<strong>18 понедельник, 18:00</strong> – Всенощная (Преображение Господне)",
          "<strong>19 вторник, 10:00</strong> – Литургия/Освящение воды и фруктов (Преображение Господне – Второй Спас)",
          "<strong>27 среда, 18:00</strong> – Всенощная (Успение Пресвятой Богородицы)",
          "<strong>28 четверг, 10:00</strong> – Литургия (Успение Пресвятой Богородицы)"
        ]
      },
      // ...fr, by, ua (добавь по аналогии!)
      fr: {
        logoLeft: ["Église", "Orthodoxe"],
        logoRight: ["Notre-Dame", "du Signe"],
        subheading: "Vicariat Sainte-Marie-de-Paris et Saint-Alexis-d’Ugine – Patriarcat Œcuménique",
        mainSchedule: [
          "<strong>16 samedi, 18:00</strong> – Vigiles (10<sup>ème</sup>&nbsp;Dimanche après la&nbsp;Pentecôte) 1<sup>er</sup>&nbsp;ton",
          "<strong>17 dimanche, 10:30</strong> – Liturgie (Sept dormants d’Ephèse)"
        ],
        fullSchedule: [
          "<strong>16 samedi, 18:00</strong> – Vigiles (10<sup>ème</sup>&nbsp;Dimanche après la&nbsp;Pentecôte) 1<sup>er</sup>&nbsp;ton",
          "<strong>17 dimanche, 10:30</strong> – Liturgie (Sept dormants d’Ephèse)",
          "<strong>18 lundi, 18:00</strong> – Vigiles (Transfiguration de&nbsp;N.S.&nbsp;Jésus-Christ)",
          "<strong>19 mardi, 10:00</strong> – Liturgie de&nbsp;la&nbsp;Transfiguration de&nbsp;N.S.&nbsp;Jésus-Christ (Bénédiction de&nbsp;l’eau et&nbsp;des fruits)",
          "<strong>27 mercredi, 18:00</strong> – Vigiles (de&nbsp;la&nbsp;Dormition)",
          "<strong>28 jeudi, 10:00</strong> – Liturgie (de&nbsp;la&nbsp;Dormition de&nbsp;la&nbsp;Très Sainte Mère de&nbsp;Dieu)"
        ]
      },
      // ...by, ua по аналогии, можно добавить.
      by: {
        logoLeft: ["Храм", "Знамення"],
        logoRight: ["Прасвятой", "Багародзіцы"],
        subheading: "Вікарыят імені Святых Марыі Парыжскай і Аляксея Южынскага — Сусветны Патрыярхат",
        mainSchedule: [
          "<strong>16 субота, 18:00</strong> – Усяночная (Тыдзень 10-ы пасля Пяцідзясятніцы) Тон 1-шы",
          "<strong>17 нядзеля, 10:30</strong> – Літургія (Святыя сем юнакоў, што былі ў&nbsp;Эфесе)"
        ],
        fullSchedule: [
          "<strong>16 субота, 18:00</strong> – Усяночная (Тыдзень 10-ы пасля Пяцідзясятніцы) Тон 1-шы",
          "<strong>17 нядзеля, 10:30</strong> – Літургія (Святыя сем юнакоў, што былі ў&nbsp;Эфесе)",
          "<strong>18 панядзелак, 18:00</strong> – Усяночная (Пераяўленне Гасподняе)",
          "<strong>19 аўторак, 10:00</strong> – Літургія, асвячэнне вады і пладоў (Пераяўленне Гасподняе&nbsp;&ndash; Другі Спас)",
          "<strong>27 серада, 18:00</strong> – Усяночная (Успенне Прасвятой Багародзіцы)",
          "<strong>28 чацвер, 10:00</strong> – Літургія (Успенне Прасвятой Багародзіцы)"
        ]
      },
      ua: {
        logoLeft: ["Храм", "Знамення"],
        logoRight: ["Пресвятої", "Богородиці"],
        subheading: "Вікаріат імені Святих Марії Паризької та Олексія Южинського — Вселенський Патріархат",
        mainSchedule: [
          "<strong>16 субота, 18:00</strong> – Всеношна (Неділя 10-та після П’ятидесятниці) Глас 1-й",
          "<strong>17 неділя, 10:30</strong> – Літургія (Семи отроків, що у Ефесі)"
        ],
        fullSchedule: [
          "<strong>16 субота, 18:00</strong> – Всеношна (Неділя 10-та після П’ятидесятниці) Глас 1-й",
          "<strong>17 неділя, 10:30</strong> – Літургія (Семи отроків, що у Ефесі)",
          "<strong>18 понеділок, 18:00</strong> – Всеношна (Преображення Господнє)",
          "<strong>19 вівторок, 10:00</strong> – Літургія, освячення води та плодів (Преображення Господнє – Другий Спас)",
          "<strong>27 середа, 18:00</strong> – Всеношна (Успіння Пресвятої Богородиці)",
          "<strong>28 четвер, 10:00</strong> – Літургія (Успіння Пресвятої Богородиці)"
        ]
      }
    };

    // --- Расписание — автоматическое удаление прошедших служб ---
    function getUpcoming(scheduleArr) {
      const now = new Date();
      for (let i = 0; i < scheduleArr.length; i++) {
        const match = scheduleArr[i].match(/<strong>(\d{1,2})\s+([а-яА-ЯёЁa-zA-Z]+),\s*(\d{1,2}):(\d{2})<\/strong>/i);
        if (!match) continue;
        let [_, day, weekday, hour, min] = match;
        let cur = new Date(now.getFullYear(), now.getMonth(), parseInt(day), parseInt(hour), parseInt(min));
        // если время прошло больше чем на 90 минут — пропустить
        if (now - cur > 90*60*1000) continue;
        // нашли первую актуальную
        return scheduleArr.slice(i);
      }
      // если все прошли — показывать пусто
      return [];
    }

    let currentLang = 'ru';
    let scheduleExpanded = false;

    function renderSchedule() {
      const t = translations[currentLang];
      const mainPanel = document.getElementById('mainSchedule');
      const hiddenPanel = document.getElementById('hiddenSchedule');
      const panel = document.getElementById('schedulePanel');

      // Вычислить ближайшие события (mainSchedule)
      const upc = getUpcoming(t.fullSchedule);
      let main, hidden;
      if (!scheduleExpanded) {
        // в "свернутом" показываем максимум 2 события (или меньше)
        main = upc.slice(0,2);
        hidden = upc.slice(2);
      } else {
        main = upc;
        hidden = [];
      }
      mainPanel.innerHTML = main.map(line => `<li>${line}</li>`).join('');
      hiddenPanel.innerHTML = hidden.length ? hidden.map(line => `<li>${line}</li>`).join('') : '';
      // показывать стрелку только если есть еще скрытые
      document.querySelector('.panel-arrow').style.opacity = hidden.length && !scheduleExpanded ? '1' : '0';
    }

    // --- Переключение языков ---
    function setLang(lang) {
      currentLang = lang;
      document.querySelectorAll('.lang-switch span').forEach(e => e.classList.remove('active'));
      document.querySelector(`.lang-switch span[data-lang="${lang}"]`).classList.add('active');

      // Название и подпись
      document.getElementById('logo-left').innerHTML = translations[lang].logoLeft.map(s=>`<span>${s}</span>`).join('');
      document.getElementById('logo-right').innerHTML = translations[lang].logoRight.map(s=>`<span>${s}</span>`).join('');
      document.getElementById('subheading').innerText = translations[lang].subheading;

      // Перерисовать расписание
      renderSchedule();
    }

    document.querySelectorAll('.lang-switch span').forEach(s => {
      s.onclick = () => setLang(s.dataset.lang);
    });

    // --- Раскрытие/скрытие расписания ---
    document.getElementById('schedulePanel').onclick = function(e) {
      // Не раскрывать если расписание полностью пустое
      const t = translations[currentLang];
      const upc = getUpcoming(t.fullSchedule);
      if (upc.length <= 2 && !scheduleExpanded) return;
      scheduleExpanded = !scheduleExpanded;
      document.getElementById('schedulePanel').classList.toggle('expanded', scheduleExpanded);
      renderSchedule();
    };

    // Стартовый рендер
    setLang('ru');

    // --- Мелкие багфиксы и UX ---
    window.addEventListener('resize', () => {
      // если расписание раскрыто и стало слишком маленьким — закрыть
      if (window.innerWidth < 400 && scheduleExpanded) {
        scheduleExpanded = false;
        document.getElementById('schedulePanel').classList.remove('expanded');
        renderSchedule();
      }
    });
  </script>
</body>
</html>
